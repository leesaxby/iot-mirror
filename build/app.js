(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var _todoList = require("./directives/todoList.js");

var _todoList2 = _interopRequireDefault(_todoList);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var app = angular.module("mirror-app", ["todo-list"]);

},{"./directives/todoList.js":2}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});

var todoList = angular.module("todo-list", []);

todoList.directive("todoList", ['WebSocket', function (webSocket) {
	return {
		retrict: "E",
		templateUrl: "./views/todo-list.html",
		controller: function ($scope) {

			webSocket.addCallback("add", function (data) {
				$scope.$apply(function () {
					$scope.todo.items.push(data.data);
				});
			});

			webSocket.addCallback("update", function (data) {
				$scope.$apply(function () {
					for (var i = 0; i < $scope.todo.items.length; i++) {
						if ($scope.todo.items[i].id === data.data.id) {
							$scope.todo.items[i].done = data.data.done;
							break;
						}
					}
				});
			});

			this.items = webSocket.initialItems;
			this.newItem = "";
			this.addItem = function () {
				var obj = {
					type: "todo_item",
					data: {
						text: this.newItem,
						done: false
					}
				};

				webSocket.sendMessage(JSON.stringify(obj));
				this.newItem = "";
			};
			this.toggleDone = function (item) {
				item.done = !item.done;

				var obj = {
					type: "update",
					data: item
				};

				webSocket.sendMessage(JSON.stringify(obj));
			};
		},
		controllerAs: "todo"
	};
}]);

exports.default = todoList;

},{}],3:[function(require,module,exports){
"use strict";

var app = angular.module("mirror-app");

app.factory("WebSocket", function () {

  var ws = new WebSocket("ws://178.62.117.150:9999", "echo-protocol");
  var initialItems = [];
  var events = {
    add: [],
    update: []
  };

  function addCallback(type, callback) {
    if (type === "add") {
      events.add.push(callback);
    }

    if (type === "update") {
      events.update.push(callback);
    }
  }

  ws.addEventListener("message", function (e) {
    var data = JSON.parse(e.data);
    if (data.type == "add") {
      for (var i = 0; i < events.add.length; i++) {
        events.add[i](data);
      }
    }

    if (data.type == "update") {
      for (var i = 0; i < events.update.length; i++) {
        events.update[i](data);
      }
    }

    if (data.type == "connect") {
      for (var i = 0; i < data.data.length; i++) {
        initialItems.push(data.data[i]);
      }
    }
  });

  function sendMessage(data) {
    ws.send(data);
  }

  return {
    initialItems: initialItems,
    sendMessage: sendMessage,
    addCallback: addCallback
  };
});

},{}]},{},[1,2,3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL2RpcmVjdGl2ZXMvdG9kb0xpc3QuanMiLCJzcmMvc2VydmljZXMvd2Vic29ja2V0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7QUNFQSxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFFLFlBQVksRUFBRSxDQUFFLFdBQVcsQ0FBRSxDQUFFLENBQUM7Ozs7Ozs7OztBQ0F6RCxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFFLFdBQVcsRUFBRSxFQUFFLENBQUUsQ0FBQzs7QUFFakQsUUFBUSxDQUFDLFNBQVMsQ0FBRSxVQUFVLEVBQUUsQ0FBRSxXQUFXLEVBQUUsVUFBVyxTQUFTLEVBQUc7QUFDckUsUUFBTztBQUNOLFNBQU8sRUFBRSxHQUFHO0FBQ1osYUFBVyxFQUFFLHdCQUF3QjtBQUNyQyxZQUFVLEVBQUUsVUFBVSxNQUFNLEVBQUc7O0FBRTlCLFlBQVMsQ0FBQyxXQUFXLENBQUUsS0FBSyxFQUFFLFVBQVUsSUFBSSxFQUFHO0FBQzlDLFVBQU0sQ0FBQyxNQUFNLENBQUMsWUFBVztBQUN4QixXQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFDLElBQUksQ0FBRSxDQUFDO0tBQ3BDLENBQUMsQ0FBQztJQUNILENBQUMsQ0FBQzs7QUFFSCxZQUFTLENBQUMsV0FBVyxDQUFFLFFBQVEsRUFBRSxVQUFVLElBQUksRUFBRztBQUNqRCxVQUFNLENBQUMsTUFBTSxDQUFDLFlBQVc7QUFDeEIsVUFBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtBQUNsRCxVQUFLLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxD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QUMvQyxjQUFNLENBQUMsTUFBTSxDQUFFLENBQUMsQ0FBRSxDQUFFLElBQUksQ0FBRSxDQUFDO09BQzVCO0tBQ0o7O0FBRUQsUUFBSyxJQUFJLENBQUMsSUFBSSxJQUFJLFNBQVMsRUFBRztBQUM1QixXQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUc7QUFDM0Msb0JBQVksQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFDLElBQUksQ0FBRSxDQUFDLENBQUUsQ0FBRSxDQUFDO09BQ3JDO0tBQ0Y7R0FDSCxDQUFDLENBQUM7O0FBRUYsV0FBUyxXQUFXLENBQUUsSUFBSSxFQUFHO0FBQzNCLE1BQUUsQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFFLENBQUM7R0FDakI7O0FBRUQsU0FBTztBQUNMLGdCQUFZLEVBQUUsWUFBWTtBQUMxQixlQUFXLEVBQUUsV0FBVztBQUN4QixlQUFXLEVBQUUsV0FBVztHQUN6QixDQUFDO0NBRUgsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB0b2RvTGlzdCBmcm9tIFwiLi9kaXJlY3RpdmVzL3RvZG9MaXN0LmpzXCI7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSggXCJtaXJyb3ItYXBwXCIsIFsgXCJ0b2RvLWxpc3RcIiBdICk7XG4iLCJcblxuXHR2YXIgdG9kb0xpc3QgPSBhbmd1bGFyLm1vZHVsZSggXCJ0b2RvLWxpc3RcIiwgW10gKTtcblxuXHR0b2RvTGlzdC5kaXJlY3RpdmUoIFwidG9kb0xpc3RcIiwgWyAnV2ViU29ja2V0JywgZnVuY3Rpb24oICB3ZWJTb2NrZXQgKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHJldHJpY3Q6IFwiRVwiLFxuXHRcdFx0dGVtcGxhdGVVcmw6IFwiLi92aWV3cy90b2RvLWxpc3QuaHRtbFwiLFxuXHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oICRzY29wZSApIHtcblxuXHRcdFx0XHR3ZWJTb2NrZXQuYWRkQ2FsbGJhY2soIFwiYWRkXCIsIGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0XHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQkc2NvcGUudG9kby5pdGVtcy5wdXNoKCBkYXRhLmRhdGEgKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0d2ViU29ja2V0LmFkZENhbGxiYWNrKCBcInVwZGF0ZVwiLCBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUudG9kby5pdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRpZiAoICRzY29wZS50b2RvLml0ZW1zW2ldLmlkID09PSBkYXRhLmRhdGEuaWQgKSB7XG5cdFx0XHRcdFx0XHRcdFx0JHNjb3BlLnRvZG8uaXRlbXNbaV0uZG9uZSA9IGRhdGEuZGF0YS5kb25lO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHRoaXMuaXRlbXMgPSB3ZWJTb2NrZXQuaW5pdGlhbEl0ZW1zO1xuXHRcdFx0XHR0aGlzLm5ld0l0ZW0gPSBcIlwiO1xuXHRcdFx0XHR0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgb2JqID0ge1xuXHRcdFx0XHRcdFx0XHRcdHR5cGU6IFwidG9kb19pdGVtXCIsXG5cdFx0XHRcdFx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGV4dDogdGhpcy5uZXdJdGVtLFxuXHRcdFx0XHRcdFx0XHRcdFx0ZG9uZTogZmFsc2Vcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHR3ZWJTb2NrZXQuc2VuZE1lc3NhZ2UoIEpTT04uc3RyaW5naWZ5KCBvYmogKSApXG5cdFx0XHRcdFx0dGhpcy5uZXdJdGVtID0gXCJcIjtcblx0XHRcdFx0fTtcblx0XHRcdFx0dGhpcy50b2dnbGVEb25lID0gZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0XHRcdFx0aXRlbS5kb25lID0gIWl0ZW0uZG9uZTtcblxuXHRcdFx0XHRcdHZhciBvYmogPSB7XG5cdFx0XHRcdFx0XHRcdFx0dHlwZTogXCJ1cGRhdGVcIixcblx0XHRcdFx0XHRcdFx0XHRkYXRhOiBpdGVtXG5cdFx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHR3ZWJTb2NrZXQuc2VuZE1lc3NhZ2UoIEpTT04uc3RyaW5naWZ5KCBvYmogKSApXG5cdFx0XHRcdH07XG5cdFx0XHR9LFxuXHRcdFx0Y29udHJvbGxlckFzOiBcInRvZG9cIlxuXHRcdH07XG5cdH1dKTtcblxuXHRleHBvcnQgZGVmYXVsdCB0b2RvTGlzdDtcbiIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSggXCJtaXJyb3ItYXBwXCIgKTtcblxuYXBwLmZhY3RvcnkoXCJXZWJTb2NrZXRcIiwgZnVuY3Rpb24oKSB7XG5cblx0dmFyIHdzID0gbmV3IFdlYlNvY2tldChcIndzOi8vMTc4LjYyLjExNy4xNTA6OTk5OVwiLCBcImVjaG8tcHJvdG9jb2xcIik7XG4gIHZhciBpbml0aWFsSXRlbXMgPSBbXTtcbiAgdmFyIGV2ZW50cyA9IHtcbiAgICBhZGQ6IFtdLFxuXHRcdHVwZGF0ZTogW11cbiAgfTtcblxuICBmdW5jdGlvbiBhZGRDYWxsYmFjayggdHlwZSwgY2FsbGJhY2sgKSB7XG4gICAgICBpZiAoIHR5cGUgPT09IFwiYWRkXCIgKSB7XG4gICAgICAgIGV2ZW50cy5hZGQucHVzaCggY2FsbGJhY2sgKTtcbiAgICAgIH1cblxuXHRcdFx0aWYgKCB0eXBlID09PSBcInVwZGF0ZVwiICkge1xuICAgICAgICBldmVudHMudXBkYXRlLnB1c2goIGNhbGxiYWNrICk7XG4gICAgICB9XG5cdH1cblxuICB3cy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKCBlLmRhdGEgKTtcbiAgICBpZiAoIGRhdGEudHlwZSA9PSBcImFkZFwiICkge1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBldmVudHMuYWRkLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgIGV2ZW50cy5hZGRbIGkgXSggZGF0YSApO1xuICAgICAgICB9XG4gICAgfVxuXG5cdFx0aWYgKCBkYXRhLnR5cGUgPT0gXCJ1cGRhdGVcIiApIHtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZXZlbnRzLnVwZGF0ZS5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICBldmVudHMudXBkYXRlWyBpIF0oIGRhdGEgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICggZGF0YS50eXBlID09IFwiY29ubmVjdFwiICkge1xuICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGF0YS5kYXRhLmxlbmd0aDsgaSsrICkge1xuICAgICAgICBpbml0aWFsSXRlbXMucHVzaCggZGF0YS5kYXRhWyBpIF0gKTtcbiAgICAgIH1cbiAgICB9XG5cdH0pO1xuXG4gIGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCBkYXRhICkge1xuICAgIHdzLnNlbmQoIGRhdGEgKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW5pdGlhbEl0ZW1zOiBpbml0aWFsSXRlbXMsXG4gICAgc2VuZE1lc3NhZ2U6IHNlbmRNZXNzYWdlLFxuICAgIGFkZENhbGxiYWNrOiBhZGRDYWxsYmFja1xuICB9O1xuXG59KTtcbiJdfQ==
