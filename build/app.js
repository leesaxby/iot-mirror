(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var _todoList = require("./directives/todoList.js");

var _todoList2 = _interopRequireDefault(_todoList);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var app = angular.module("mirror-app", ["todo-list"]);

},{"./directives/todoList.js":2}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var todoList = angular.module("todo-list", []);

todoList.directive("todoList", ['WebSocket', function (webSocket) {
  return {
    retrict: "E",
    templateUrl: "./views/todo-list.html",
    controller: function ($scope) {

      webSocket.addCallback("add", function (data) {
        $scope.$apply(function () {
          $scope.todo.items.push(data.data);
        });
      });

      webSocket.addCallback("update", function (data) {
        $scope.$apply(function () {
          for (var i = 0; i < $scope.todo.items.length; i++) {
            if ($scope.todo.items[i].id === data.data.id) {
              $scope.todo.items[i].done = data.data.done;
              break;
            }
          }
        });
      });

      this.items = webSocket.initialItems;
      this.newItem = "";
      this.addItem = function () {
        var obj = {
          type: "todo_item",
          data: {
            text: this.newItem,
            done: false
          }
        };

        webSocket.sendMessage(JSON.stringify(obj));
        this.newItem = "";
      };
      this.toggleDone = function (item) {
        item.done = !item.done;

        var obj = {
          type: "update",
          data: item
        };

        webSocket.sendMessage(JSON.stringify(obj));
      };
    },
    controllerAs: "todo"
  };
}]);

exports.default = todoList;

},{}],3:[function(require,module,exports){
"use strict";

var app = angular.module("mirror-app");

app.factory("WebSocket", function () {

  var ws = new WebSocket("ws://178.62.117.150:9999", "echo-protocol");
  var initialItems = [];
  var events = {
    add: [],
    update: []
  };

  function addCallback(type, callback) {
    if (type === "add") {
      events.add.push(callback);
    }

    if (type === "update") {
      events.update.push(callback);
    }
  }

  ws.addEventListener("message", function (e) {
    var data = JSON.parse(e.data);
    if (data.type === "add") {
      for (var i = 0; i < events.add.length; i++) {
        events.add[i](data);
      }
    }

    if (data.type === "update") {
      for (var i = 0; i < events.update.length; i++) {
        events.update[i](data);
      }
    }

    if (data.type === "connect") {
      for (var i = 0; i < data.data.length; i++) {
        initialItems.push(data.data[i]);
      }
    }
  });

  function sendMessage(data) {
    ws.send(data);
  }

  return {
    initialItems: initialItems,
    sendMessage: sendMessage,
    addCallback: addCallback
  };
});

},{}]},{},[1,2,3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL2RpcmVjdGl2ZXMvdG9kb0xpc3QuanMiLCJzcmMvc2VydmljZXMvd2Vic29ja2V0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7QUNFQSxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFFLFlBQVksRUFBRSxDQUFFLFdBQVcsQ0FBRSxDQUFFLENBQUM7Ozs7Ozs7OztBQ0F4RCxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFFLFdBQVcsRUFBRSxFQUFFLENBQUUsQ0FBQzs7QUFFakQsUUFBUSxDQUFDLFNBQVMsQ0FBRSxVQUFVLEVBQUUsQ0FBRSxXQUFXLEVBQUUsVUFBVyxTQUFTLEVBQUc7QUFDcEUsU0FBTztBQUNMLFdBQU8sRUFBRSxHQUFHO0FBQ1osZUFBVyxFQUFFLHdCQUF3QjtBQUNyQyxjQUFVLEVBQUUsVUFBVSxNQUFNLEVBQUc7O0FBRTdCLGVBQVMsQ0FBQyxXQUFXLENBQUUsS0FBSyxFQUFFLFVBQVUsSUFBSSxFQUFHO0FBQzdDLGNBQU0sQ0FBQyxNQUFNLENBQUMsWUFBVztBQUN2QixnQkFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFFLElBQUksQ0FBQyxJQUFJLENBQUUsQ0FBQztTQUNyQyxDQUFDLENBQUM7T0FDSixDQUFDLENBQUM7O0FBRUgsZUFBUyxDQUFDLFdBQVcsQ0FBRSxRQUFRLEVBQUUsVUFBVSxJQUFJLEVBQUc7QUFDaEQsY0FBTSxDQUFDLE1BQU0sQ0FBQyxZQUFXO0FBQ3ZCLGVBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDakQsZ0JBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFL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QUUsRUFBRztBQUMvQyxjQUFNLENBQUMsTUFBTSxDQUFFLENBQUMsQ0FBRSxDQUFFLElBQUksQ0FBRSxDQUFDO09BQzVCO0tBQ0Y7O0FBRUQsUUFBSyxJQUFJLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRztBQUM3QixXQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUc7QUFDM0Msb0JBQVksQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFDLElBQUksQ0FBRSxDQUFDLENBQUUsQ0FBRSxDQUFDO09BQ3JDO0tBQ0Y7R0FDRixDQUFDLENBQUM7O0FBRUgsV0FBUyxXQUFXLENBQUUsSUFBSSxFQUFHO0FBQzNCLE1BQUUsQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFFLENBQUM7R0FDakI7O0FBRUQsU0FBTztBQUNMLGdCQUFZLEVBQUUsWUFBWTtBQUMxQixlQUFXLEVBQUUsV0FBVztBQUN4QixlQUFXLEVBQUUsV0FBVztHQUN6QixDQUFDO0NBRUgsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB0b2RvTGlzdCBmcm9tIFwiLi9kaXJlY3RpdmVzL3RvZG9MaXN0LmpzXCI7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSggXCJtaXJyb3ItYXBwXCIsIFsgXCJ0b2RvLWxpc3RcIiBdICk7XG4iLCJcblxuICB2YXIgdG9kb0xpc3QgPSBhbmd1bGFyLm1vZHVsZSggXCJ0b2RvLWxpc3RcIiwgW10gKTtcblxuICB0b2RvTGlzdC5kaXJlY3RpdmUoIFwidG9kb0xpc3RcIiwgWyAnV2ViU29ja2V0JywgZnVuY3Rpb24oICB3ZWJTb2NrZXQgKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJldHJpY3Q6IFwiRVwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiLi92aWV3cy90b2RvLWxpc3QuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oICRzY29wZSApIHtcblxuICAgICAgICB3ZWJTb2NrZXQuYWRkQ2FsbGJhY2soIFwiYWRkXCIsIGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUudG9kby5pdGVtcy5wdXNoKCBkYXRhLmRhdGEgKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgd2ViU29ja2V0LmFkZENhbGxiYWNrKCBcInVwZGF0ZVwiLCBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUudG9kby5pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBpZiAoICRzY29wZS50b2RvLml0ZW1zW2ldLmlkID09PSBkYXRhLmRhdGEuaWQgKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZG8uaXRlbXNbaV0uZG9uZSA9IGRhdGEuZGF0YS5kb25lO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuaXRlbXMgPSB3ZWJTb2NrZXQuaW5pdGlhbEl0ZW1zO1xuICAgICAgICB0aGlzLm5ld0l0ZW0gPSBcIlwiO1xuICAgICAgICB0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwidG9kb19pdGVtXCIsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5uZXdJdGVtLFxuICAgICAgICAgICAgICAgICAgZG9uZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICB3ZWJTb2NrZXQuc2VuZE1lc3NhZ2UoIEpTT04uc3RyaW5naWZ5KCBvYmogKSApXG4gICAgICAgICAgdGhpcy5uZXdJdGVtID0gXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50b2dnbGVEb25lID0gZnVuY3Rpb24oIGl0ZW0gKSB7XG4gICAgICAgICAgaXRlbS5kb25lID0gIWl0ZW0uZG9uZTtcblxuICAgICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJ1cGRhdGVcIixcbiAgICAgICAgICAgICAgICBkYXRhOiBpdGVtXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICB3ZWJTb2NrZXQuc2VuZE1lc3NhZ2UoIEpTT04uc3RyaW5naWZ5KCBvYmogKSApXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgY29udHJvbGxlckFzOiBcInRvZG9cIlxuICAgIH07XG4gIH1dKTtcblxuICBleHBvcnQgZGVmYXVsdCB0b2RvTGlzdDtcbiIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSggXCJtaXJyb3ItYXBwXCIgKTtcblxuYXBwLmZhY3RvcnkoXCJXZWJTb2NrZXRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgdmFyIHdzID0gbmV3IFdlYlNvY2tldChcIndzOi8vMTc4LjYyLjExNy4xNTA6OTk5OVwiLCBcImVjaG8tcHJvdG9jb2xcIik7XG4gIHZhciBpbml0aWFsSXRlbXMgPSBbXTtcbiAgdmFyIGV2ZW50cyA9IHtcbiAgICBhZGQ6IFtdLFxuICAgIHVwZGF0ZTogW11cbiAgfTtcblxuICBmdW5jdGlvbiBhZGRDYWxsYmFjayggdHlwZSwgY2FsbGJhY2sgKSB7XG4gICAgaWYgKCB0eXBlID09PSBcImFkZFwiICkge1xuICAgICAgZXZlbnRzLmFkZC5wdXNoKCBjYWxsYmFjayApO1xuICAgIH1cblxuICAgIGlmICggdHlwZSA9PT0gXCJ1cGRhdGVcIiApIHtcbiAgICAgIGV2ZW50cy51cGRhdGUucHVzaCggY2FsbGJhY2sgKTtcbiAgICB9XG4gIH1cblxuICB3cy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKCBlLmRhdGEgKTtcbiAgICBpZiAoIGRhdGEudHlwZSA9PT0gXCJhZGRcIiApIHtcbiAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGV2ZW50cy5hZGQubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgIGV2ZW50cy5hZGRbIGkgXSggZGF0YSApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICggZGF0YS50eXBlID09PSBcInVwZGF0ZVwiICkge1xuICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZXZlbnRzLnVwZGF0ZS5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgZXZlbnRzLnVwZGF0ZVsgaSBdKCBkYXRhICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCBkYXRhLnR5cGUgPT09IFwiY29ubmVjdFwiICkge1xuICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGF0YS5kYXRhLmxlbmd0aDsgaSsrICkge1xuICAgICAgICBpbml0aWFsSXRlbXMucHVzaCggZGF0YS5kYXRhWyBpIF0gKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCBkYXRhICkge1xuICAgIHdzLnNlbmQoIGRhdGEgKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW5pdGlhbEl0ZW1zOiBpbml0aWFsSXRlbXMsXG4gICAgc2VuZE1lc3NhZ2U6IHNlbmRNZXNzYWdlLFxuICAgIGFkZENhbGxiYWNrOiBhZGRDYWxsYmFja1xuICB9O1xuXG59KTtcbiJdfQ==
